let[@pred] isOpened (p : Path.t) =
  _F
    (OpenFile ((p [@d]), y, v, v)
    && _X (_G (not (CloseFile ((p [@d]), v, true)))))

let[@pred] canWriteP (p : Path.t) =
  _F
    (OpenFile ((p [@d]), y, v, v && can_write y)
    && _X (_G (not (CloseFile ((p [@d]), v, true)))))

let[@pred] canReadP (p : Path.t) =
  _F
    (OpenFile ((p [@d]), y, v, v && can_read y)
    && _X (_G (not (CloseFile ((p [@d]), v, true)))))

let[@pred] renameP (p : Path.t) =
  _F
    (CloseFile ((p [@d]), v, true);
     Rename ((p [@d]), y, v, is_babuk_renamed y))
